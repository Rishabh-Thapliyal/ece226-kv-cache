nohup: ignoring input
cuda
STAGE:2025-03-19 18:45:51 2408571:2408571 ActivityProfilerController.cpp:314] Completed Stage: Warm Up
/home/rthapliyal/ece226-kv-cache/project/inference_penn.py:60: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  tokens[k, :torch.tensor(t).shape[-1]] = torch.tensor(t, dtype=torch.long, device=device).squeeze(0)
Generating tokens:   0%|                                                                                                | 0/42 [00:00<?, ?it/s][W CPUAllocator.cpp:249] Memory block of unknown size was allocated before the profiling started, profiler results will not include the deallocation event
Generating tokens:   2%|██                                                                                      | 1/42 [00:00<00:08,  4.93it/s]Generating tokens:  31%|██████████████████████████▉                                                            | 13/42 [00:00<00:00, 52.25it/s]Generating tokens:  62%|█████████████████████████████████████████████████████▊                                 | 26/42 [00:00<00:00, 79.70it/s]Generating tokens:  93%|████████████████████████████████████████████████████████████████████████████████▊      | 39/42 [00:00<00:00, 94.89it/s]Generating tokens: 100%|███████████████████████████████████████████████████████████████████████████████████████| 42/42 [00:00<00:00, 77.74it/s]
Generating tokens:   0%|                                                                                                | 0/55 [00:00<?, ?it/s]Generating tokens:  24%|████████████████████▎                                                                 | 13/55 [00:00<00:00, 124.09it/s]Generating tokens:  47%|████████████████████████████████████████▋                                             | 26/55 [00:00<00:00, 123.61it/s]Generating tokens:  71%|████████████████████████████████████████████████████████████▉                         | 39/55 [00:00<00:00, 124.00it/s]Generating tokens:  95%|█████████████████████████████████████████████████████████████████████████████████▎    | 52/55 [00:00<00:00, 124.23it/s]Generating tokens: 100%|██████████████████████████████████████████████████████████████████████████████████████| 55/55 [00:00<00:00, 123.63it/s]
Generating tokens:   0%|                                                                                                | 0/38 [00:00<?, ?it/s]Generating tokens:  34%|█████████████████████████████▍                                                        | 13/38 [00:00<00:00, 122.75it/s]Generating tokens:  68%|██████████████████████████████████████████████████████████▊                           | 26/38 [00:00<00:00, 124.20it/s]Generating tokens: 100%|██████████████████████████████████████████████████████████████████████████████████████| 38/38 [00:00<00:00, 123.99it/s]
Generating tokens:   0%|                                                                                                | 0/47 [00:00<?, ?it/s]Generating tokens:  28%|███████████████████████▊                                                              | 13/47 [00:00<00:00, 123.24it/s]Generating tokens:  55%|███████████████████████████████████████████████▌                                      | 26/47 [00:00<00:00, 124.76it/s]Generating tokens:  83%|███████████████████████████████████████████████████████████████████████▎              | 39/47 [00:00<00:00, 125.22it/s]Generating tokens: 100%|██████████████████████████████████████████████████████████████████████████████████████| 47/47 [00:00<00:00, 124.44it/s]
Generating tokens:   0%|                                                                                                | 0/59 [00:00<?, ?it/s]Generating tokens:  22%|██████████████████▉                                                                   | 13/59 [00:00<00:00, 123.50it/s]Generating tokens:  44%|█████████████████████████████████████▉                                                | 26/59 [00:00<00:00, 124.17it/s]Generating tokens:  66%|████████████████████████████████████████████████████████▊                             | 39/59 [00:00<00:00, 124.44it/s]Generating tokens:  88%|███████████████████████████████████████████████████████████████████████████▊          | 52/59 [00:00<00:00, 122.33it/s]Generating tokens: 100%|██████████████████████████████████████████████████████████████████████████████████████| 59/59 [00:00<00:00, 122.07it/s]
Generating tokens:   0%|                                                                                                | 0/40 [00:00<?, ?it/s]Generating tokens:  32%|███████████████████████████▉                                                          | 13/40 [00:00<00:00, 126.40it/s]Generating tokens:  65%|███████████████████████████████████████████████████████▉                              | 26/40 [00:00<00:00, 125.13it/s]Generating tokens:  98%|███████████████████████████████████████████████████████████████████████████████████▊  | 39/40 [00:00<00:00, 123.50it/s]Generating tokens: 100%|██████████████████████████████████████████████████████████████████████████████████████| 40/40 [00:00<00:00, 124.02it/s]
Generating tokens:   0%|                                                                                                | 0/44 [00:00<?, ?it/s]Generating tokens:  30%|█████████████████████████▍                                                            | 13/44 [00:00<00:00, 127.23it/s]Generating tokens:  59%|██████████████████████████████████████████████████▊                                   | 26/44 [00:00<00:00, 125.98it/s]Generating tokens:  89%|████████████████████████████████████████████████████████████████████████████▏         | 39/44 [00:00<00:00, 125.84it/s]Generating tokens: 100%|██████████████████████████████████████████████████████████████████████████████████████| 44/44 [00:00<00:00, 125.58it/s]
Generating tokens:   0%|                                                                                                | 0/66 [00:00<?, ?it/s]Generating tokens:  20%|████████████████▉                                                                     | 13/66 [00:00<00:00, 124.17it/s]Generating tokens:  39%|█████████████████████████████████▉                                                    | 26/66 [00:00<00:00, 124.45it/s]Generating tokens:  59%|██████████████████████████████████████████████████▊                                   | 39/66 [00:00<00:00, 124.63it/s]Generating tokens:  79%|███████████████████████████████████████████████████████████████████▊                  | 52/66 [00:00<00:00, 123.05it/s]Generating tokens:  98%|████████████████████████████████████████████████████████████████████████████████████▋ | 65/66 [00:00<00:00, 121.09it/s]Generating tokens: 100%|██████████████████████████████████████████████████████████████████████████████████████| 66/66 [00:00<00:00, 122.23it/s]
Generating tokens:   0%|                                                                                                | 0/41 [00:00<?, ?it/s]Generating tokens:  32%|███████████████████████████▎                                                          | 13/41 [00:00<00:00, 124.27it/s]Generating tokens:  63%|██████████████████████████████████████████████████████▌                               | 26/41 [00:00<00:00, 125.11it/s]Generating tokens:  95%|█████████████████████████████████████████████████████████████████████████████████▊    | 39/41 [00:00<00:00, 125.48it/s]Generating tokens: 100%|██████████████████████████████████████████████████████████████████████████████████████| 41/41 [00:00<00:00, 125.00it/s]
Generating tokens:   0%|                                                                                                | 0/32 [00:00<?, ?it/s]Generating tokens:  41%|██████████████████████████████████▉                                                   | 13/32 [00:00<00:00, 127.61it/s]Generating tokens:  81%|█████████████████████████████████████████████████████████████████████▉                | 26/32 [00:00<00:00, 126.64it/s]Generating tokens: 100%|██████████████████████████████████████████████████████████████████████████████████████| 32/32 [00:00<00:00, 124.96it/s]
Generating tokens:   0%|                                                                                                | 0/30 [00:00<?, ?it/s]Generating tokens:  43%|█████████████████████████████████████▎                                                | 13/30 [00:00<00:00, 125.22it/s]Generating tokens:  87%|██████████████████████████████████████████████████████████████████████████▌           | 26/30 [00:00<00:00, 126.08it/s]Generating tokens: 100%|██████████████████████████████████████████████████████████████████████████████████████| 30/30 [00:00<00:00, 125.38it/s]
Generating tokens:   0%|                                                                                                | 0/72 [00:00<?, ?it/s]Generating tokens:  18%|███████████████▌                                                                      | 13/72 [00:00<00:00, 126.23it/s]Generating tokens:  36%|███████████████████████████████                                                       | 26/72 [00:00<00:00, 126.03it/s]Generating tokens:  54%|██████████████████████████████████████████████▌                                       | 39/72 [00:00<00:00, 126.03it/s]Generating tokens:  72%|██████████████████████████████████████████████████████████████                        | 52/72 [00:00<00:00, 123.88it/s]Generating tokens:  90%|█████████████████████████████████████████████████████████████████████████████▋        | 65/72 [00:00<00:00, 120.13it/s]Generating tokens: 100%|██████████████████████████████████████████████████████████████████████████████████████| 72/72 [00:00<00:00, 120.91it/s]
Generating tokens:   0%|                                                                                                | 0/56 [00:00<?, ?it/s]Generating tokens:  23%|███████████████████▉                                                                  | 13/56 [00:00<00:00, 124.97it/s]Generating tokens:  46%|███████████████████████████████████████▉                                              | 26/56 [00:00<00:00, 125.07it/s]Generating tokens:  70%|███████████████████████████████████████████████████████████▉                          | 39/56 [00:00<00:00, 123.15it/s]Generating tokens:  93%|███████████████████████████████████████████████████████████████████████████████▊      | 52/56 [00:00<00:00, 120.26it/s]Generating tokens: 100%|██████████████████████████████████████████████████████████████████████████████████████| 56/56 [00:00<00:00, 121.16it/s]
Generating tokens:   0%|                                                                                                | 0/43 [00:00<?, ?it/s]Generating tokens:  30%|██████████████████████████                                                            | 13/43 [00:00<00:00, 126.09it/s]Generating tokens:  60%|████████████████████████████████████████████████████                                  | 26/43 [00:00<00:00, 125.93it/s]Generating tokens:  91%|██████████████████████████████████████████████████████████████████████████████        | 39/43 [00:00<00:00, 126.13it/s]Generating tokens: 100%|██████████████████████████████████████████████████████████████████████████████████████| 43/43 [00:00<00:00, 125.92it/s]
Generating tokens:   0%|                                                                                                | 0/37 [00:00<?, ?it/s]Generating tokens:  35%|██████████████████████████████▏                                                       | 13/37 [00:00<00:00, 124.57it/s]Generating tokens:  70%|████████████████████████████████████████████████████████████▍                         | 26/37 [00:00<00:00, 124.62it/s]Generating tokens: 100%|██████████████████████████████████████████████████████████████████████████████████████| 37/37 [00:00<00:00, 124.32it/s]
Generating tokens:   0%|                                                                                                | 0/51 [00:00<?, ?it/s]Generating tokens:  25%|█████████████████████▉                                                                | 13/51 [00:00<00:00, 124.97it/s]Generating tokens:  51%|███████████████████████████████████████████▊                                          | 26/51 [00:00<00:00, 125.86it/s]Generating tokens:  76%|█████████████████████████████████████████████████████████████████▊                    | 39/51 [00:00<00:00, 125.91it/s]Generating tokens: 100%|██████████████████████████████████████████████████████████████████████████████████████| 51/51 [00:00<00:00, 126.02it/s]
Generating tokens:   0%|                                                                                                | 0/41 [00:00<?, ?it/s]Generating tokens:  32%|███████████████████████████▎                                                          | 13/41 [00:00<00:00, 124.84it/s]Generating tokens:  63%|██████████████████████████████████████████████████████▌                               | 26/41 [00:00<00:00, 124.75it/s]Generating tokens:  95%|█████████████████████████████████████████████████████████████████████████████████▊    | 39/41 [00:00<00:00, 124.09it/s]Generating tokens: 100%|██████████████████████████████████████████████████████████████████████████████████████| 41/41 [00:00<00:00, 124.21it/s]
Generating tokens:   0%|                                                                                                | 0/40 [00:00<?, ?it/s]Generating tokens:  32%|███████████████████████████▉                                                          | 13/40 [00:00<00:00, 125.81it/s]Generating tokens:  65%|███████████████████████████████████████████████████████▉                              | 26/40 [00:00<00:00, 125.39it/s]Generating tokens:  98%|███████████████████████████████████████████████████████████████████████████████████▊  | 39/40 [00:00<00:00, 122.80it/s]Generating tokens: 100%|██████████████████████████████████████████████████████████████████████████████████████| 40/40 [00:00<00:00, 123.39it/s]
Generating tokens:   0%|                                                                                                | 0/30 [00:00<?, ?it/s]Generating tokens:  43%|█████████████████████████████████████▎                                                | 13/30 [00:00<00:00, 125.17it/s]Generating tokens:  87%|██████████████████████████████████████████████████████████████████████████▌           | 26/30 [00:00<00:00, 125.43it/s]Generating tokens: 100%|██████████████████████████████████████████████████████████████████████████████████████| 30/30 [00:00<00:00, 125.69it/s]
Generating tokens:   0%|                                                                                                | 0/40 [00:00<?, ?it/s]Generating tokens:  32%|███████████████████████████▉                                                          | 13/40 [00:00<00:00, 124.70it/s]Generating tokens:  65%|███████████████████████████████████████████████████████▉                              | 26/40 [00:00<00:00, 124.26it/s]Generating tokens:  98%|███████████████████████████████████████████████████████████████████████████████████▊  | 39/40 [00:00<00:00, 123.57it/s]Generating tokens: 100%|██████████████████████████████████████████████████████████████████████████████████████| 40/40 [00:00<00:00, 123.48it/s]
STAGE:2025-03-19 18:46:32 2408571:2408571 ActivityProfilerController.cpp:320] Completed Stage: Collection
STAGE:2025-03-19 18:46:33 2408571:2408571 ActivityProfilerController.cpp:324] Completed Stage: Post Processing
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg       CPU Mem  Self CPU Mem      CUDA Mem  Self CUDA Mem    # of Calls  Total MFLOPs  
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
                                           aten::matmul         7.16%     509.964ms        23.10%        1.646s      95.841us     454.875ms         6.20%        1.735s     101.000us           0 b           0 b       3.16 Gb      -3.49 Gb         17176            --  
                                           aten::linear         2.67%     190.361ms        20.81%        1.483s     109.342us     183.972ms         2.51%        1.552s     114.430us           0 b           0 b       2.53 Gb           0 b         13560            --  
                                           aten::unbind         7.40%     527.279ms        20.54%        1.464s     646.671us     443.228ms         6.05%        1.471s     649.724us           0 b           0 b           0 b           0 b          2264            --  
                                           aten::select         8.70%     620.092ms        11.39%     811.339ms       8.314us     861.281ms        11.75%        1.129s      11.566us           0 b           0 b           0 b           0 b         97592            --  
                                             aten::item         5.73%     408.118ms         7.73%     550.822ms       8.742us     469.880ms         6.41%     720.435ms      11.434us           0 b           0 b           0 b           0 b         63010            --  
                                          aten::reshape         3.42%     243.451ms         7.05%     502.214ms      17.361us     274.322ms         3.74%     587.981ms      20.326us           0 b           0 b       5.58 Gb           0 b         28928            --  
                                               aten::mm         3.82%     272.249ms         5.47%     389.806ms      28.747us     524.954ms         7.16%     524.954ms      38.713us           0 b           0 b       2.53 Gb       2.53 Gb         13560    688332.734  
                                       aten::as_strided         0.38%      26.950ms         0.40%      28.792ms       0.190us     476.414ms         6.50%     476.414ms       3.142us           0 b           0 b           0 b           0 b        151614            --  
                                        cudaEventRecord        23.16%        1.651s        23.51%        1.676s       1.089us       0.000us         0.00%     401.356ms       0.261us     144.37 Kb     -37.83 Kb      -1.89 Gb      -1.89 Gb       1538784            --  
                                                aten::t         1.48%     105.212ms         3.99%     284.416ms      20.975us     141.391ms         1.93%     329.916ms      24.330us           0 b           0 b           0 b           0 b         13560            --  
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 7.126s
Self CUDA time total: 7.332s

Total CUDA Memory Usage: 0.00 MB
Total CPU Memory Usage: 0.00 MB
tensor(9841.4324, device='cuda:0', dtype=torch.float64)
