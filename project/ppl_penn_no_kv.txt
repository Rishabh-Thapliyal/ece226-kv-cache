nohup: ignoring input
cuda
False False
STAGE:2025-03-19 19:32:59 2382489:2382489 ActivityProfilerController.cpp:314] Completed Stage: Warm Up
/home/rthapliyal/ece226-kv-cache/project/inference_penn.py:91: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  tokens[k, :torch.tensor(t).shape[-1]] = torch.tensor(t, dtype=torch.long, device=device).squeeze(0)
Generating tokens:   0%|                                                                                         | 0/42 [00:00<?, ?it/s][W CPUAllocator.cpp:249] Memory block of unknown size was allocated before the profiling started, profiler results will not include the deallocation event
Generating tokens:   2%|█▉                                                                               | 1/42 [00:00<00:08,  5.01it/s]Generating tokens:  29%|██████████████████████▊                                                         | 12/42 [00:00<00:00, 48.68it/s]Generating tokens:  57%|█████████████████████████████████████████████▋                                  | 24/42 [00:00<00:00, 72.77it/s]Generating tokens:  83%|██████████████████████████████████████████████████████████████████▋             | 35/42 [00:00<00:00, 84.48it/s]Generating tokens: 100%|████████████████████████████████████████████████████████████████████████████████| 42/42 [00:00<00:00, 72.04it/s]
Generating tokens:   0%|                                                                                         | 0/55 [00:00<?, ?it/s]Generating tokens:  24%|██████████████████▋                                                            | 13/55 [00:00<00:00, 121.21it/s]Generating tokens:  47%|█████████████████████████████████████▎                                         | 26/55 [00:00<00:00, 119.38it/s]Generating tokens:  69%|██████████████████████████████████████████████████████▌                        | 38/55 [00:00<00:00, 117.12it/s]Generating tokens:  91%|███████████████████████████████████████████████████████████████████████▊       | 50/55 [00:00<00:00, 112.68it/s]Generating tokens: 100%|███████████████████████████████████████████████████████████████████████████████| 55/55 [00:00<00:00, 113.37it/s]
Generating tokens:   0%|                                                                                         | 0/38 [00:00<?, ?it/s]Generating tokens:  34%|███████████████████████████                                                    | 13/38 [00:00<00:00, 120.45it/s]Generating tokens:  68%|██████████████████████████████████████████████████████                         | 26/38 [00:00<00:00, 119.42it/s]Generating tokens: 100%|███████████████████████████████████████████████████████████████████████████████| 38/38 [00:00<00:00, 115.37it/s]Generating tokens: 100%|███████████████████████████████████████████████████████████████████████████████| 38/38 [00:00<00:00, 116.46it/s]
Generating tokens:   0%|                                                                                         | 0/47 [00:00<?, ?it/s]Generating tokens:  26%|████████████████████▏                                                          | 12/47 [00:00<00:00, 114.43it/s]Generating tokens:  51%|████████████████████████████████████████▎                                      | 24/47 [00:00<00:00, 116.49it/s]Generating tokens:  77%|████████████████████████████████████████████████████████████▌                  | 36/47 [00:00<00:00, 116.44it/s]Generating tokens: 100%|███████████████████████████████████████████████████████████████████████████████| 47/47 [00:00<00:00, 114.15it/s]
Generating tokens:   0%|                                                                                         | 0/59 [00:00<?, ?it/s]Generating tokens:  20%|████████████████                                                               | 12/59 [00:00<00:00, 119.85it/s]Generating tokens:  41%|████████████████████████████████▏                                              | 24/59 [00:00<00:00, 119.87it/s]Generating tokens:  61%|████████████████████████████████████████████████▏                              | 36/59 [00:00<00:00, 116.27it/s]Generating tokens:  81%|████████████████████████████████████████████████████████████████▎              | 48/59 [00:00<00:00, 110.89it/s]Generating tokens: 100%|███████████████████████████████████████████████████████████████████████████████| 59/59 [00:00<00:00, 110.12it/s]
Generating tokens:   0%|                                                                                         | 0/40 [00:00<?, ?it/s]Generating tokens:  30%|███████████████████████▋                                                       | 12/40 [00:00<00:00, 115.76it/s]Generating tokens:  60%|███████████████████████████████████████████████▍                               | 24/40 [00:00<00:00, 117.03it/s]Generating tokens:  90%|███████████████████████████████████████████████████████████████████████        | 36/40 [00:00<00:00, 115.30it/s]Generating tokens: 100%|███████████████████████████████████████████████████████████████████████████████| 40/40 [00:00<00:00, 115.14it/s]
Generating tokens:   0%|                                                                                         | 0/44 [00:00<?, ?it/s]Generating tokens:  27%|█████████████████████▌                                                         | 12/44 [00:00<00:00, 115.35it/s]Generating tokens:  55%|███████████████████████████████████████████                                    | 24/44 [00:00<00:00, 117.69it/s]Generating tokens:  82%|████████████████████████████████████████████████████████████████▋              | 36/44 [00:00<00:00, 116.36it/s]Generating tokens: 100%|███████████████████████████████████████████████████████████████████████████████| 44/44 [00:00<00:00, 115.12it/s]
Generating tokens:   0%|                                                                                         | 0/66 [00:00<?, ?it/s]Generating tokens:  18%|██████████████▎                                                                | 12/66 [00:00<00:00, 115.80it/s]Generating tokens:  36%|████████████████████████████▋                                                  | 24/66 [00:00<00:00, 117.50it/s]Generating tokens:  55%|███████████████████████████████████████████                                    | 36/66 [00:00<00:00, 115.75it/s]Generating tokens:  73%|█████████████████████████████████████████████████████████▍                     | 48/66 [00:00<00:00, 110.74it/s]Generating tokens:  91%|███████████████████████████████████████████████████████████████████████▊       | 60/66 [00:00<00:00, 107.10it/s]Generating tokens: 100%|███████████████████████████████████████████████████████████████████████████████| 66/66 [00:00<00:00, 108.04it/s]
Generating tokens:   0%|                                                                                         | 0/41 [00:00<?, ?it/s]Generating tokens:  29%|███████████████████████                                                        | 12/41 [00:00<00:00, 119.18it/s]Generating tokens:  61%|████████████████████████████████████████████████▏                              | 25/41 [00:00<00:00, 120.14it/s]Generating tokens:  93%|█████████████████████████████████████████████████████████████████████████▏     | 38/41 [00:00<00:00, 117.00it/s]Generating tokens: 100%|███████████████████████████████████████████████████████████████████████████████| 41/41 [00:00<00:00, 116.77it/s]
Generating tokens:   0%|                                                                                         | 0/32 [00:00<?, ?it/s]Generating tokens:  38%|█████████████████████████████▋                                                 | 12/32 [00:00<00:00, 119.64it/s]Generating tokens:  75%|███████████████████████████████████████████████████████████▎                   | 24/32 [00:00<00:00, 119.15it/s]Generating tokens: 100%|███████████████████████████████████████████████████████████████████████████████| 32/32 [00:00<00:00, 118.09it/s]
Generating tokens:   0%|                                                                                         | 0/30 [00:00<?, ?it/s]Generating tokens:  43%|██████████████████████████████████▏                                            | 13/30 [00:00<00:00, 122.22it/s]Generating tokens:  87%|████████████████████████████████████████████████████████████████████▍          | 26/30 [00:00<00:00, 119.22it/s]Generating tokens: 100%|███████████████████████████████████████████████████████████████████████████████| 30/30 [00:00<00:00, 118.34it/s]
Generating tokens:   0%|                                                                                         | 0/72 [00:00<?, ?it/s]Generating tokens:  18%|██████████████▎                                                                | 13/72 [00:00<00:00, 122.86it/s]Generating tokens:  36%|████████████████████████████▌                                                  | 26/72 [00:00<00:00, 119.38it/s]Generating tokens:  53%|█████████████████████████████████████████▋                                     | 38/72 [00:00<00:00, 117.34it/s]Generating tokens:  69%|██████████████████████████████████████████████████████▊                        | 50/72 [00:00<00:00, 112.96it/s]Generating tokens:  86%|████████████████████████████████████████████████████████████████████           | 62/72 [00:00<00:00, 106.50it/s]Generating tokens: 100%|███████████████████████████████████████████████████████████████████████████████| 72/72 [00:00<00:00, 107.19it/s]
Generating tokens:   0%|                                                                                         | 0/56 [00:00<?, ?it/s]Generating tokens:  21%|████████████████▉                                                              | 12/56 [00:00<00:00, 119.64it/s]Generating tokens:  43%|█████████████████████████████████▊                                             | 24/56 [00:00<00:00, 119.40it/s]Generating tokens:  64%|██████████████████████████████████████████████████▊                            | 36/56 [00:00<00:00, 117.48it/s]Generating tokens:  86%|███████████████████████████████████████████████████████████████████▋           | 48/56 [00:00<00:00, 112.43it/s]Generating tokens: 100%|███████████████████████████████████████████████████████████████████████████████| 56/56 [00:00<00:00, 111.51it/s]
Generating tokens:   0%|                                                                                         | 0/43 [00:00<?, ?it/s]Generating tokens:  28%|██████████████████████                                                         | 12/43 [00:00<00:00, 119.95it/s]Generating tokens:  56%|████████████████████████████████████████████                                   | 24/43 [00:00<00:00, 119.45it/s]Generating tokens:  84%|██████████████████████████████████████████████████████████████████▏            | 36/43 [00:00<00:00, 117.52it/s]Generating tokens: 100%|███████████████████████████████████████████████████████████████████████████████| 43/43 [00:00<00:00, 116.68it/s]
Generating tokens:   0%|                                                                                         | 0/37 [00:00<?, ?it/s]Generating tokens:  35%|███████████████████████████▊                                                   | 13/37 [00:00<00:00, 121.02it/s]Generating tokens:  70%|███████████████████████████████████████████████████████▌                       | 26/37 [00:00<00:00, 119.40it/s]Generating tokens: 100%|███████████████████████████████████████████████████████████████████████████████| 37/37 [00:00<00:00, 117.99it/s]
Generating tokens:   0%|                                                                                         | 0/51 [00:00<?, ?it/s]Generating tokens:  25%|████████████████████▏                                                          | 13/51 [00:00<00:00, 120.12it/s]Generating tokens:  51%|████████████████████████████████████████▎                                      | 26/51 [00:00<00:00, 119.71it/s]Generating tokens:  75%|██████████████████████████████████████████████████████████▊                    | 38/51 [00:00<00:00, 117.49it/s]Generating tokens:  98%|█████████████████████████████████████████████████████████████████████████████▍ | 50/51 [00:00<00:00, 114.08it/s]Generating tokens: 100%|███████████████████████████████████████████████████████████████████████████████| 51/51 [00:00<00:00, 115.60it/s]
Generating tokens:   0%|                                                                                         | 0/41 [00:00<?, ?it/s]Generating tokens:  29%|███████████████████████                                                        | 12/41 [00:00<00:00, 119.72it/s]Generating tokens:  59%|██████████████████████████████████████████████▏                                | 24/41 [00:00<00:00, 118.68it/s]Generating tokens:  88%|█████████████████████████████████████████████████████████████████████▎         | 36/41 [00:00<00:00, 116.48it/s]Generating tokens: 100%|███████████████████████████████████████████████████████████████████████████████| 41/41 [00:00<00:00, 116.67it/s]
Generating tokens:   0%|                                                                                         | 0/40 [00:00<?, ?it/s]Generating tokens:  32%|█████████████████████████▋                                                     | 13/40 [00:00<00:00, 120.73it/s]Generating tokens:  65%|███████████████████████████████████████████████████▎                           | 26/40 [00:00<00:00, 119.64it/s]Generating tokens:  95%|███████████████████████████████████████████████████████████████████████████    | 38/40 [00:00<00:00, 117.04it/s]Generating tokens: 100%|███████████████████████████████████████████████████████████████████████████████| 40/40 [00:00<00:00, 117.71it/s]
Generating tokens:   0%|                                                                                         | 0/30 [00:00<?, ?it/s]Generating tokens:  43%|██████████████████████████████████▏                                            | 13/30 [00:00<00:00, 120.68it/s]Generating tokens:  87%|████████████████████████████████████████████████████████████████████▍          | 26/30 [00:00<00:00, 120.09it/s]Generating tokens: 100%|███████████████████████████████████████████████████████████████████████████████| 30/30 [00:00<00:00, 119.10it/s]
Generating tokens:   0%|                                                                                         | 0/40 [00:00<?, ?it/s]Generating tokens:  32%|█████████████████████████▋                                                     | 13/40 [00:00<00:00, 120.96it/s]Generating tokens:  65%|███████████████████████████████████████████████████▎                           | 26/40 [00:00<00:00, 118.91it/s]Generating tokens:  95%|███████████████████████████████████████████████████████████████████████████    | 38/40 [00:00<00:00, 116.58it/s]Generating tokens: 100%|███████████████████████████████████████████████████████████████████████████████| 40/40 [00:00<00:00, 116.93it/s]
STAGE:2025-03-19 19:33:39 2382489:2382489 ActivityProfilerController.cpp:320] Completed Stage: Collection
STAGE:2025-03-19 19:33:41 2382489:2382489 ActivityProfilerController.cpp:324] Completed Stage: Post Processing
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg       CPU Mem  Self CPU Mem      CUDA Mem  Self CUDA Mem    # of Calls  Total GFLOPs  
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
                                           aten::matmul         6.80%     529.104ms        22.97%        1.788s     104.087us     388.444ms         4.60%        3.042s     177.102us           0 b           0 b      61.12 Gb      -7.07 Gb         17176            --  
                                           aten::linear         2.39%     186.134ms        19.71%        1.535s     113.165us     144.276ms         1.71%        2.648s     195.308us           0 b           0 b      56.75 Gb           0 b         13560            --  
                                               aten::mm         3.64%     283.643ms         5.15%     400.988ms      29.571us        1.808s        21.40%        1.808s     133.318us           0 b           0 b      56.75 Gb      56.75 Gb         13560     16844.355  
                                           aten::unbind         6.75%     525.624ms        18.63%        1.451s     640.708us     442.656ms         5.24%        1.457s     643.744us           0 b           0 b           0 b           0 b          2264            --  
                                           aten::select         7.86%     611.505ms        10.47%     814.989ms       8.351us     824.064ms         9.76%        1.091s      11.180us           0 b           0 b           0 b           0 b         97592            --  
                                             aten::item         4.76%     370.708ms         6.87%     535.067ms       8.492us     463.389ms         5.49%     712.618ms      11.310us           0 b           0 b           0 b           0 b         63010            --  
                                          aten::reshape         3.26%     253.548ms         8.31%     647.235ms      22.374us     266.240ms         3.15%     693.609ms      23.977us           0 b           0 b       8.24 Gb           0 b         28928            --  
                                            aten::clone         1.92%     149.693ms         5.82%     452.764ms      42.521us     138.991ms         1.65%     450.851ms      42.341us     452.00 Kb           0 b      12.07 Gb           0 b         10648            --  
                                       aten::as_strided         0.37%      29.136ms         0.37%      29.136ms       0.202us     438.434ms         5.19%     438.434ms       3.037us           0 b           0 b           0 b           0 b        144382            --  
                                            aten::copy_         1.57%     122.113ms        10.28%     800.019ms      49.308us     240.172ms         2.84%     293.195ms      18.071us      20.25 Kb    -205.50 Kb           0 b           0 b         16225            --  
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 7.784s
Self CUDA time total: 8.447s

Total CUDA Memory Usage: 0.00 MB
Total CPU Memory Usage: 0.00 MB
tensor(9841.4325, device='cuda:0', dtype=torch.float64)
